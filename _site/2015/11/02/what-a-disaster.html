<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title></title>
  <style type="text/css">
  body
  {
    margin:40px auto;
    max-width:680px;
    line-height:1.4;
    font-size:120%;
    color:#111;
    padding:0 10px;
    background-color: #FDFDFD;
  }

  a{
    text-decoration: none;
    color: cornflowerblue;
  }

  a:hover{
    text-decoration: underline;
  }

  h1,h2,h3
  {
    line-height:1.2;
  }

  article{
    margin-top:200px;
  }
  .caption{
    width:100%;
  }
  .centered{
    margin:0 auto;
    display:block;
  }

  code{
    font-size:1em;
    white-space: pre;
    background-color:ghostwhite;
    display:block;
    overflow: auto;
    padding: 0.6em 0.8em;
  }


  </style>
</head>

  
  <body>
  
  <div class="container content">
      <header class="masthead">
        <h2 class="masthead-title">
          <a href="/" title="Home">Steven LoFurno</a>
          
             
              &nbsp;&nbsp;&nbsp;
              <small><a href="/about">About</a></small>
            
              &nbsp;&nbsp;&nbsp;
              <small><a href="/">Posts</a></small>
            
              &nbsp;&nbsp;&nbsp;
              <small><a href="/projects">Projects</a></small>
            
        </h2>
        <small>a programming blog by a retired pro-gamer</small>
      </header>
      
    <main>
        <article>
  <h1 class="post-title">what a disaster (statically linking go binaries for 32 bit alpine linux)</h1>
  <time datetime="2015-11-02T00:00:00-05:00" class="post-date">02 Nov 2015</time>
  <p>in progress…</p>

<p>http://alpinelinux.org/downloads/
http://wiki.alpinelinux.org/wiki/Install_to_disk
setup-alpine</p>

<p>mount -t iso9660 /dev/cdrom /media/</p>

<p>echo “/media/apks” » /etc/apk/repositories</p>

<p>/var/cache/apks
http://nl.alpinelinux.org/alpine/v3.2/main
#http://nl.alpinelinux.org/alpine/edge/main
#http://nl.alpinelinux.org/alpine/edge/testing</p>

<p>http://wiki.alpinelinux.org/wiki/Connecting_to_a_wireless_access_point</p>

<p>wpa_supplicant -Dwext -iwlan0 -c ./wpa.conf
udhcpc -i wlan0
ubuntu: iface wlan0 inet dhcp
 dhclient -i wlan0
 or something??
 /etc/ssh/sshd_config -&gt; make sure rootlogin isnt without-pass
 service ssh restart</p>

<p>go binary dist is hardcoded to use gcc…
alpine uses http://www.musl-libc.org/
go compiler doesnt work
go binaries compiled for linux dont work</p>

<p>env GOOS=linux GOARCH=386 go build -a .</p>

<p>Trace/breakpoint trap</p>

<p>echo 1 &gt; /proc/sys/kernel/modify_ldt</p>

<p>https://github.com/golang/go/search?utf8=%E2%9C%93&amp;q=modify_ldt</p>

<pre><code>When linking against the system libraries, we use its pthread_create... To insulate the rest of the tool chain from this ugliness, 8l rewrites 0(TLS) into -4(GS) for us.

// call modify_ldt
MOVL	$1, BX	// func = 1 (write)
MOVL	AX, CX	// user_desc
MOVL	$16, DX	// sizeof(user_desc)
MOVL	$123, AX	// syscall - modify_ldt
INVOKE_SYSINFO
</code></pre>

<p>wrong version of libuv…
cause package repo had main commented out</p>

<p>http://git.alpinelinux.org/cgit/aports/tree/main/nodejs/APKBUILD
http://git.alpinelinux.org/cgit/aports/tree/main/nodejs/APKBUILD?id=75cc781209536288b4522d523e2575c184312869</p>

<p>apk add python openssl-dev zlib-dev libuv-dev	linux-headers paxmark</p>

<p>./configure –shared-zlib –shared-libuv –shared-openssl</p>

<p>paxctl -cm /usr/local/bin/node</p>

</article>

    </main>
    
   </div>
   
   <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-68120130-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>